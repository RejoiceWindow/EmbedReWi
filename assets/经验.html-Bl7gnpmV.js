import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as r,d as i,o as n}from"./app-DIMvcjhy.js";const a={};function p(l,t){return n(),r("div",null,t[0]||(t[0]=[i('<h2 id="长城c01吸顶屏v32未收到主机背光值dtc诊断报错-5w-风险评估-报告" tabindex="-1"><a class="header-anchor" href="#长城c01吸顶屏v32未收到主机背光值dtc诊断报错-5w-风险评估-报告"><span>长城C01吸顶屏V32未收到主机背光值DTC诊断报错-5W&amp;风险评估-报告</span></a></h2><p>在显示屏上电10s内，<br> 情况1. 未收到背光开关和背光亮度指令\v情况2. 未收到背光开关，只收到背光亮度指令（未开启背光不响应调光）\v情况3. 收到背光开关，未收到背光亮度指令（但收到背光开指令，会以默认亮度点亮）\v情况4. 未收到背光开关和背光亮度指令时，进入了升级模式（升级中不响应调光）</p><p>现象一：显示触摸正常，但有DTC上报<br> 分析：符合情况3<br> 原因：两个指令都收到时才不会报此DTC</p><p>现象二：背光上电就未打开过出现DTC<br> 分析：主机LOG情况如图，属于软件BUG<br> 原因：在V3.2时，软件程序中把记录收到设置背光亮度指令的变量放在了正常调光的地方，忽略了收到背光关指令会不响应调光，变量就没有被改变。10s到了就会记录未收到背光的DTC。</p><p>软件更新<br> 2024年4月11日发布的 V3.3已修正：将记录收到背光亮度值的变量移到不响应调光逻辑外，即：即使背光关，收到背光亮度指令也记录。下面为软件改善流程图。</p><ol start="2"><li>软件升级<br> 对低版本的吸顶屏进行软件升级，此软件BUG将不会存在。</li></ol><table><thead><tr><th style="text-align:center;">风险源</th><th style="text-align:center;">现状管控</th><th style="text-align:center;">剩余风险</th></tr></thead><tbody><tr><td style="text-align:center;">生产时使用V32版本软件</td><td style="text-align:center;">生产人员获取到的软件为最新软件，且有软件版本监控</td><td style="text-align:center;">无</td></tr><tr><td style="text-align:center;">库存中存在V32版本软件</td><td style="text-align:center;">目前仅保定徐水一个仓库，每次都由驻场人员更新到最新</td><td style="text-align:center;">无</td></tr><tr><td style="text-align:center;">V32版本此BUG影响用户体验</td><td style="text-align:center;">对于DTC功能，目前在主机仅记录，不会展示给客户。在主机正常情况下，吸顶屏只会在上电就一直关闭背光的情况下才会出现此DTC，只需要点亮一次吸顶屏，此DTC就会消失。因此不会影响用户体验。</td><td style="text-align:center;">无</td></tr><tr><td style="text-align:center;">V32版本其他问题影响用户体验</td><td style="text-align:center;">V3.4才修复的，断电瓶才能恢复通信，出现概率低，如果车不休眠掉电，就不容易出现。V3.5才修复的下拉菜单栏卡住现象，出现概率很低，多滑一下就恢复了。</td><td style="text-align:center;">无建议升级为最新</td></tr></tbody></table><h2 id="触摸卡顿-4月29日" tabindex="-1"><a class="header-anchor" href="#触摸卡顿-4月29日"><span>触摸卡顿 4月29日</span></a></h2><p>问题描述：实车吸顶屏下拉快捷面板时仅显示了一半的下拉界面<br> 问题发生时间：2024年4月29日 16:19左右<br> 问题现象：</p><p>问题现象：主机端从Log数据中分析，怀疑是屏端少上报了Up事件导致</p><ol><li>台架双指上滑<br> 1.1 复现手法：在下拉快捷面板下，手指1调节背光滑动条，手指2上拉收起界面，可以出现下拉快捷面板只显示一半的情况</li></ol><p>1.台架双指上滑<br> 1.2 原因分析：采集到出现问题前后的I2C数据，发现屏MCU是有上报Up的数据给主机的</p><ol start="2"><li><p>台架单指下滑<br> 问题现象：</p></li><li><p>台架单指下滑<br> 原因分析：当屏MCU读取到TP报点数据时，主机立刻来读取诊断信息，导致屏MCU识别到I2C总线在忙(有数据正在传输)，所以屏MCU没有再拉CRQ中断请求主机来读取触摸数据， 从而使主机丢失了Up的事件。</p></li><li><p>台架单指下滑<br> 主机日志：出现问题的时间点，有一个Down的事件，坐标还在继续变化，但最后没有Up的事件，所以导致下拉界面仅显示一半。</p></li><li><p>针对前面提到的第2点的解决方案：<br> 改善措施：在屏MCU与主机的IIC总线传输数据完成后，屏MCU增加一个判断“是否还有最新数据需要上报给主机？”，如有最新数据需要上报，MCU就会重新拉CRQ通知主机来读取。<br> 更改影响：更新屏MCU软件<br> 更改周期：6月4日能改完屏MCU的软件软件<br> 改后风险：目前只增加一个判断逻辑，改动量不大，无风险<br> 改后效果：</p></li><li><p>触摸数据的实测波形：<br> TP芯片触发一次中断, 屏MCU读取数据的总时长在1.874437ms左右：</p></li></ol><p>屏触发一次CRQ, 主机读取数据的总时长在4.467562ms左右, 所以主机获取最新TP数据的延时时间在4.46ms左右：</p><h2 id="长城c01吸顶屏dtc诊断报错-0902" tabindex="-1"><a class="header-anchor" href="#长城c01吸顶屏dtc诊断报错-0902"><span>长城C01吸顶屏DTC诊断报错--0902</span></a></h2><p>2024年8月29日 16:07<br> 经过路试和过淋雨 后进行功能检测，人员<br> 点击中控“后排娱乐屏”，发现娱乐屏打不开。<br> 什么原因？<br> 华阳运动机构控制器软件逻辑不合理</p><p>结论先行：华阳运动机构控制器软件逻辑不合理。<br> DMA接收到的数据 跨越接收区的尾部和头部，且从地址0开始的时间帧中有数据0x7A，长度位置有大于DMA搬运函数入口地址的值，会导致DMA搬运函数被覆盖而无法运行，从而导致收不到命令，机构不响应。<br> DMA接收区是一个200字节长度的环形区，当出现时间帧(1分钟发送14字节)和心跳帧(1秒发送6字节)或其他数据帧同时发过来，且这2帧数据的一部分保存在接收区的尾部一部分在头部。当时间帧数据中出现0x7A数据会被误判为帧头，其后面0xC7A长度的数据会导致DMA搬运函数入口地址被覆盖，回调函数不运行，无法响应新命令，最终表现为机构无反应。<br> 备注：当时间帧的毫秒出现0x7A/0X17A/0X27A/0X37A时，也就是尾数是0x7A</p><p>对策方案<br> a. 修改接收数组长度为200字节（如下图）<br> b. 增加处理机制：<br> 1). 根据实际数据存取位置读取数据；<br> 2). 增加帧数据长度判断，超过0x0A为无效；<br> 3). 增加接收CMD ID判断，超过0x13为无效；</p><hr><h2 id="成都实车吸顶屏软件升级失败问题分析报告-20240617" tabindex="-1"><a class="header-anchor" href="#成都实车吸顶屏软件升级失败问题分析报告-20240617"><span>成都实车吸顶屏软件升级失败问题分析报告_20240617</span></a></h2><p>问题排查情况：</p><ol><li>屏MCU软件版本V3.0, 升级V3.4软件的过程中失败<br> 2.升级显示屏MCU时, 在擦除阶段会返回NOT OK状态, 导致升级失败</li><li>确定是只有这台车会出现升级擦除失败，其他车不会</li><li>确认升级包头部信息是正确的, 升级包没有做错</li><li>升级TP或机构软件时可以升级成功, 说明整个升级链路是没有问题的<br> 最终结论：<br> MCU预留升级线，复位线裸露，偶尔触发接地，导致MCU复位，升级失败</li></ol><h2 id="c01青岛花屏问题分析-20240802" tabindex="-1"><a class="header-anchor" href="#c01青岛花屏问题分析-20240802"><span>C01青岛花屏问题分析_20240802</span></a></h2><p>问题发生时间：2024年8月2号12:30-14:00<br> 问题发生经过：<br> 1、2024年8月2号中午12:30分4S店正在录制车辆宣传视频，拍摄至后排吸顶屏时，发现吸顶屏黑屏，进行盲触摸，发现触摸正常（语音开启视频播放，调整进度，调整音量）<br> 2、随后工作人员确认将车辆进行锁车操作（过一会全车休眠，然后整车下电），关锁约5分钟，然后解锁车辆；<br> 3、解锁车辆时，立刻发现吸顶屏出现如下视频所示的花屏画面（见视频）<br> 4、最后4S店人员对车辆电瓶负极进行断电操作，异常恢复，且不复现</p><p>吸顶黑屏问题分析：\v1、08-01 16:26:26.404时间点，在主机退出STR后，soc和串行器983芯片（吸顶屏）进行dp training时出现失败的情况；\v2、16:26:27.215时间点，在soc和983第二次进行dp training时，dp速率因未知原因降至1.62Gbps，未按照设定的2.7Gbps速率通信，导致吸顶屏出现黑屏异常；\v3、后续多次STR唤醒，高通DP驱动仍按照1.62Gbps速率进行dp training，导致吸顶屏黑屏一直无法恢复；\v4、08-02 14:19断蓄电池重启后，soc和吸顶屏983使用2.7Gbps速率dp training成功，吸顶屏恢复显示。</p><p>为什么吸顶屏会报TCON和TFT故障：<br> 根据主机查询信息，8月1号至2号断开电瓶前期间，高通DP驱动仍按照1.62Gbps速率进行dp training，导致吸顶屏黑屏一直无法恢复，此时TCON跟TDDI收到错误的视频源，因此会LVDS信号异常跟TCON错误；</p><p>总结：本次黑屏花屏问题，是由于主机输出的视频信号错误而导致的，下一步待主机厂进一步分析；</p><h2 id="实车吸顶屏软件升级失败问题分析报告" tabindex="-1"><a class="header-anchor" href="#实车吸顶屏软件升级失败问题分析报告"><span>实车吸顶屏软件升级失败问题分析报告</span></a></h2><p>问题描述：实车吸顶屏软件升级失败<br> 问题发生时间：2024年6月12日 14:51:40左右<br> 问题现象：</p><p>问题排查情况：</p><ol><li>屏MCU软件版本V3.0, 升级V3.4软件的过程中失败</li><li>升级显示屏MCU时, 在擦除阶段会返回NOT OK状态, 导致升级失败</li><li>确定是只有这台车会出现升级擦除失败，其他车不会</li><li>确认升级包头部信息是正确的, 升级包没有做错</li><li>升级TP或机构软件时可以升级成功, 说明整个升级链路是没有问题的</li><li>成都的同事到实车现场用测试板连接吸顶屏测试软件升级, 结果也是失败的</li><li>不在升级软件的情况下, 也可以看到串行解串器Lock→Unlock→Lock的情况</li></ol><p>2024-6-19：<br> 收到从成都寄回的问题样件#1<br> 用样件#1测试屏MCU软件升级功能<br> 结果：升级成功, 没有复现到实车上的问题<br> 安排多次升级MCU_V3.0的软件<br> 升级过程中晃动或者拉扯屏电源线和LVDS线<br> 结果：都升级成功, 没有复现到实车上的问题</p><p>2024-6-20：<br> 对问题样件#1进行升级压测<br> 压测一天没有复现到升级失败的问题</p><p>为什么会升级失败？\v因为升级过程中MCU的烧录线中Reset Pin表皮破损严重, 且接触到结构外壳导致MCU复位, 所以升级失败<br> 为什么只升级MCU软件时会升级失败, 但升级机构或者触摸的软件时又是成功的？\v因为升级MCU软件需耗时98.9s, 时间较长, 且是在升级进度到50 %左右出现升级失败的；\v而升级触摸软件只需耗时19s, 升级机构软件耗时35s, 且触摸和机构软件升级都只试过一次；\v所以出现升级MCU软件失败, 但升级机构和触摸软件成功的现象。<br> MCU复位时屏幕会黑, 但实车并没有报黑屏的问题, 为什么？\v因为MCU从复位到恢复的时间很短, 表现可能只是闪一下, 如果实车上测试人员不是一直盯着吸顶屏看的话, 确实很难察觉到这个问题</p><ol start="4"><li>为什么样件寄回惠州后无法再复现到问题？\v因为在惠州的台架上, 卡扣是松弛的,<br> 并没有压到烧录线, 所以无法再复现到问题</li></ol>',35)]))}const c=e(a,[["render",p]]),b=JSON.parse('{"path":"/reference/%E7%BB%8F%E9%AA%8C.html","title":"经验","lang":"zh-CN","frontmatter":{"lang":"zh-CN","title":"经验","description":"项目经验","icon":"arcticons:pixel-experience","tag":["QA"],"category":["interview"],"head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"经验\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-04-25T09:36:15.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"ReWi\\",\\"url\\":\\"https://gitee.com/re-wi\\",\\"email\\":\\"RejoiceWindow@yeah.net\\"},{\\"@type\\":\\"Person\\",\\"name\\":\\"ReWi\\",\\"url\\":\\"https://github.com/Re-Wi/\\",\\"email\\":\\"RejoiceWindow@yeah.net\\"},{\\"@type\\":\\"Person\\",\\"name\\":\\"RejoiceWindow\\"}]}"],["meta",{"property":"og:url","content":"https://em.rewi.xyz/reference/%E7%BB%8F%E9%AA%8C.html"}],["meta",{"property":"og:site_name","content":"EmbedReWi"}],["meta",{"property":"og:title","content":"经验"}],["meta",{"property":"og:description","content":"项目经验"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-04-25T09:36:15.000Z"}],["meta",{"property":"article:tag","content":"QA"}],["meta",{"property":"article:modified_time","content":"2025-04-25T09:36:15.000Z"}],["link",{"rel":"alternate","type":"application/rss+xml","href":"https://em.rewi.xyz/rss.xml","title":"EmbedReWi RSS Feed"}]]},"git":{"createdTime":1745573775000,"updatedTime":1745573775000,"contributors":[{"name":"ReWi","username":"","email":"RejoiceWindow@yeah.net","commits":1}]},"readingTime":{"minutes":9.86,"words":2958},"filePathRelative":"reference/经验.md","localizedDate":"2025年4月25日","excerpt":"<h2>长城C01吸顶屏V32未收到主机背光值DTC诊断报错-5W&amp;风险评估-报告</h2>\\n<p>在显示屏上电10s内，<br>\\n情况1. 未收到背光开关和背光亮度指令\\u000b情况2. 未收到背光开关，只收到背光亮度指令（未开启背光不响应调光）\\u000b情况3. 收到背光开关，未收到背光亮度指令（但收到背光开指令，会以默认亮度点亮）\\u000b情况4. 未收到背光开关和背光亮度指令时，进入了升级模式（升级中不响应调光）</p>\\n<p>现象一：显示触摸正常，但有DTC上报<br>\\n分析：符合情况3<br>\\n原因：两个指令都收到时才不会报此DTC</p>\\n<p>现象二：背光上电就未打开过出现DTC<br>\\n分析：主机LOG情况如图，属于软件BUG<br>\\n原因：在V3.2时，软件程序中把记录收到设置背光亮度指令的变量放在了正常调光的地方，忽略了收到背光关指令会不响应调光，变量就没有被改变。10s到了就会记录未收到背光的DTC。</p>"}');export{c as comp,b as data};
